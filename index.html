<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Outback Gems</title>
  <link rel="stylesheet" href="index.css" />
  <link rel="stylesheet" href="navbar.css" />
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Parisienne&display=swap" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Dancing+Script&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Sacramento&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Allura&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Satisfy&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
</head>

<body>

  <header id="navbar-container"></header>

  <section id="home">
    <div class="hero-overlay">
      <h2>Your Destination for Premium Faceting Rough and Australian Gems &amp; Minerals</h2>
      <p>Explore our range of high-quality faceting rough, including synthetic and natural stones, minerals, and a
        variety of faceting and fossicking essentials.</p>
    </div>
  </section>


  <div class="banner-slider">
    <div class="banner">
      <div class="banner-item">
        <p>Free Shipping On Orders Over $100</p>
      </div>
      <div class="banner-item">
        <p>Express Shipping From $14.45</p>
      </div>
      <div class="banner-item">
        <p>Winter Sale: 50% Off All Synthetic Rough</p>
      </div>
    </div>
  </div>

  <section class="about-us">

    <div class="who-we-are">
      <h2>Who We Are</h2>
      <p>Outback Gems &amp; Minerals specializes in gemstone rough, with a focus on natural and synthetic faceting
        materials. We provide high-quality materials that cater to the needs of faceting enthusiasts, hobbyists, and
        collectors.</p>
    </div>

    <div class="what-we-do">
      <h2>What We Do</h2>
      <p>We offer a broad range of products for faceting, fossicking, and collecting, from sapphires and zircons to
        unique minerals and other essentials. Our goal is to make high-quality materials easily accessible for those who
        appreciate the craft and beauty of gemstones.</p>
    </div>


    <!-- <div class="Why-Choose-Usr"> Possibly add in as a Fourth Box 
      <h2>Why Choose Us</h2>
      <p>With firsthand experience in fossicking and faceting, we know what makes quality rough. We handpick stock that delivers both beauty and value to cutters and collectors alike.</p>
  </div> -->


    <div class="what-we-offer">
      <h2>What We Offer</h2>
      <ul>
        <li>Premium Australian sapphires, zircons, garnets &amp; other materials</li>
        <li>High-quality synthetic faceting rough</li>
        <li>Gemstone wash bags for fossicking at home</li>
        <li>A wide range of minerals and related products</li>
      </ul>
    </div>

  </section>

  <section id="bestsellers">
    <div class="bestsellers-container">
      <div class="bestselling-header-box">
        <h2 class="bestselling-header">Bestselling Items</h2>
      </div>

      <div class="divider"></div>

      <div class="bestseller-product-cards">
        <!-- Bestseller product cards will be injected here by JavaScript -->
      </div>

      <button class="view-all-button">View All Products</button>
    </div>
  </section>

  <section class="whats-new-carousel">
    <div class="whats-new-header-box">
      <h2 class="whats-new-header">What's New</h2>
    </div>
    <div class="divider"></div>
    <div class="swiper whats-new-swiper">
      <div class="swiper-wrapper">
        <!-- Whats New product cards will be injected here as .swiper-slide by JS -->
      </div>
      <div class="swiper-button-next"></div>
      <div class="swiper-button-prev"></div>
      <!-- Pagination is hidden by CSS, but you can remove this line if you wish -->
      <div class="swiper-pagination"></div>
    </div>
    <button class="view-all-button">View All Products</button>
  </section>

  <div class="newsletter-divider"></div>

  <section class="newsletter-signup">
    <div class="newsletter-container">
      <h2>Sign Up for Our Newsletter</h2>

       
       
      <p>Stay updated with the latest news and offers from Outback Gems &amp; Minerals get an email every few blah blah blah
        blha.</p>
      <form action="submit_form.php" method="POST">
        <input type="email" name="email" placeholder="Enter your email" required />
        <button type="submit">Subscribe</button>
      </form>
    </div>
  </section>


  <footer>
    <div class="footer-left">
      <p><a href="Privacy Policy.docx" target="_blank">Privacy Policy</a></p>
      <p><a href="Terms of Use.docx" target="_blank">Terms Of Use</a></p>
    </div>
    <div class="footer-middle">
      <p>&copy; 2025 Outback Gems &amp; Minerals. All rights reserved.</p>
      <P>ABN: 0123456789</P>
    </div>
    <div class="footer-right">
      <p><a href="outbackgems@outlook.com"><i class="fa fa-envelope" aria-hidden="true" style="color:white"></i></a></p>
      <p><a href="https://www.facebook.com/"><i class="fa fa-facebook-square" aria-hidden="true"
            style="color:white"></i></a></p>
    </div>
  </footer>

  <script src="navbar.js"></script>
  
  <script>
  // Background image rotation
  const images = ["images/Banner 1.jpg", "images/Banner 2.jpg", "images/Banner 3.jpg", "images/Banner 4.jpg"];
    let current = 0;

    setInterval(() => {
      current = (current + 1) % images.length;
      document.getElementById("home").style.backgroundImage = `url('${images[current]}')`;
    }, 15000); // Change image every 15 seconds

    // #region banner carousel script
    const itemTrack = document.querySelector('.banner');
    const items = document.querySelectorAll('.banner-item');
    const visibleMessages = 1;
    let itemIndex = 0;
  
    // Clone first item(s) and append to end only if there are enough items
    if (items.length > visibleMessages) {
      for (let i = 0; i < visibleMessages; i++) {
        const clone = items[i].cloneNode(true);
        itemTrack.appendChild(clone);
      }
    }
  
    const totalItems = document.querySelectorAll('.banner-item').length;
    setInterval(() => {
      itemIndex++;
      itemTrack.style.transition = 'transform 0.7s ease-in-out';
      itemTrack.style.transform = `translateX(-${itemIndex * 100}%)`;
  
      if (itemIndex === totalItems - visibleMessages) {
        setTimeout(() => {
          itemTrack.style.transition = 'none';
          itemTrack.style.transform = `translateX(0%)`;
          itemIndex = 0;
        }, 700); // Match the transition duration
      }
    }, 5000);
    // #endregion
  
    // #region whats new carousel script
    const productTrack = document.querySelector('.carousel-track');
    const products = document.querySelectorAll('.new-product-card');
    const visibleCount = 3;
    let productIndex = 0;
  
    // Clone first visibleCount cards and append to the end only if there are enough cards
    if (products.length > visibleCount) {
      for (let i = 0; i < visibleCount; i++) {
        const clone = products[i].cloneNode(true);
        productTrack.appendChild(clone);
      }
    }
  
    const totalCards = document.querySelectorAll('.new-product-card').length;
    const cardWidth = 100 / totalCards;
    setInterval(() => {
      productIndex++;
      productTrack.style.transition = 'transform 0.7s ease-in-out';
      productTrack.style.transform = `translateX(-${productIndex * (100 / visibleCount)}%)`;
  
      // Reset position after animation if clone limit reached
      if (productIndex === products.length) {
        setTimeout(() => {
          productTrack.style.transition = 'none';
          productTrack.style.transform = `translateX(0%)`;
          productIndex = 0;
        }, 700); // Match the transition duration
      }
    }, 7000); // Rotate every 7 seconds
    // #endregion
  
      // Newsletter form validation
  document.querySelector('.newsletter-container form').addEventListener('submit', function (e) {
    e.preventDefault(); // Prevent the default form submission

    const emailInput = document.querySelector('input[name="email"]');
    const email = emailInput.value.trim();
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/; // Basic email validation regex

    if (!emailRegex.test(email)) {
      alert('Please enter a valid email address.');
      return;
    }

    // Simulate successful submission
    alert('Thank you for subscribing!');
    emailInput.value = ''; // Clear the input field
  });
  
    // Dynamically load the shared navbar
    document.addEventListener('DOMContentLoaded', () => {
      fetch('navbar.html') // Ensure the file path is correct
        .then(response => {
          if (!response.ok) {
            throw new Error(`Failed to load navbar. Status: ${response.status}`);
          }
          return response.text();
        })
        .then(data => {
          document.querySelector('header').innerHTML = data;
        })
        .catch(error => {
          console.error('Error loading navbar:', error);
          document.querySelector('header').innerHTML = '<p style="color: red;">Failed to load navbar. Please try again later.</p>';
        });
    });
  
    // Dynamically load the navbar
    document.addEventListener("DOMContentLoaded", () => {
      fetch("navbar.html")
        .then(response => {
          if (!response.ok) {
            throw new Error(`Failed to load navbar. Status: ${response.status}`);
          }
          return response.text();
        })
        .then(html => {
          const navbarContainer = document.querySelector("header") || document.getElementById("navbar-container");
          if (navbarContainer) {
            navbarContainer.innerHTML = html;

            // Update the cart count and dropdown after the navbar is loaded
            updateCartCount();
            updateCartDropdown();
          }
        })
        .catch(error => {
          console.error("Error loading navbar:", error);
        });
    });

    // Function to update the cart count
    function updateCartCount() {
      const cart = JSON.parse(localStorage.getItem("cart")) || [];
      const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
      const cartCountElement = document.getElementById("cart-count");

      if (cartCountElement) {
        cartCountElement.textContent = totalItems;
      } else {
        console.error("Cart count element not found in the navbar.");
      }
    }

    // Function to update the cart dropdown
    function updateCartDropdown() {
      const cart = JSON.parse(localStorage.getItem("cart")) || [];
      const cartItemsList = document.getElementById("cart-items-list");
      const cartMessage = document.getElementById("cart-message");
      const cartSubtotal = document.getElementById("cart-subtotal");
      const cartTotal = document.getElementById("cart-total");

      if (!cartItemsList || !cartMessage || !cartSubtotal || !cartTotal) {
        console.error("Cart dropdown elements not found in the DOM.");
        return;
      }

      if (cart.length === 0) {
        cartMessage.textContent = "Your cart is empty.";
        cartItemsList.innerHTML = "";
        cartSubtotal.textContent = "$0.00";
        cartTotal.textContent = "$0.00";
        return;
      }

      let subtotal = 0;
      cartItemsList.innerHTML = ""; // Clear existing items

      cart.forEach(item => {
        const itemTotal = item.price * item.quantity;
        subtotal += itemTotal;

        const cartItem = document.createElement("div");
        cartItem.classList.add("cart-item");

        cartItem.innerHTML = `
          <img src="${item.image}" alt="${item.name}" style="width: 50px; height: 50px; object-fit: cover; margin-right: 10px;">
          <div class="cart-item-details">
            <span class="product-name">${item.name}</span>
            <span class="product-code">Code: ${item.id}</span>
            <span class="product-quantity">Qty: ${item.quantity}</span>
          </div>
          <div class="cart-item-price">$${(item.price * item.quantity).toFixed(2)}</div>
        `;

        cartItemsList.appendChild(cartItem);
      });

      cartMessage.textContent = `You currently have ${cart.length} items in your cart.`;
      cartSubtotal.textContent = `$${subtotal.toFixed(2)}`;
      cartTotal.textContent = `$${subtotal.toFixed(2)}`;
    }

    // Listen for cart updates and refresh the dropdown
    document.addEventListener("cartUpdated", () => {
      updateCartCount();
      updateCartDropdown();
    });

    document.addEventListener("DOMContentLoaded", function () {
  const bestsellerGrid = document.querySelector('.bestseller-product-cards');

  // Add loading message
  const loadingMsg = document.createElement("div");
  loadingMsg.textContent = "Loading Bestsellers...";
  loadingMsg.style.color = "#cc5500";
  loadingMsg.style.fontSize = "2rem";
  loadingMsg.style.textAlign = "center";
  loadingMsg.style.padding = "40px 0";
  bestsellerGrid.appendChild(loadingMsg);

  // Fetch product data (replace with your actual endpoint if different)
  fetch("https://script.google.com/macros/s/AKfycbyCY8VW0D1A7AFJiU7X6tN5-RTrnYxQIV4QCzmFprxYrCVv2o4uKWnmKfJ6Xh40H4uqXA/exec")
    .then(response => response.json())
    .then(data => {
      // Remove loading message
      bestsellerGrid.innerHTML = "";

      // Shuffle and pick 3 random products
      const shuffled = data.sort(() => 0.5 - Math.random()).slice(0, 3);

      shuffled.forEach(product => {
        const card = document.createElement("div");
        card.className = "bestseller-product-card";

        // Image
        const imageContainer = document.createElement("div");
        imageContainer.className = "image-container";
        const img = document.createElement("img");
        img.src = product["image url"];
        img.alt = product["product name"] || "Product Image";
        imageContainer.appendChild(img);

        // Name
        const name = document.createElement("h3");
        name.textContent = product["product name"];

        // Description
        const desc = document.createElement("p");
        desc.textContent = product.description;

        // Price
        const price = document.createElement("p");
        price.className = "price";
        price.textContent = `$${product["price per unit"]} per ${product.unit}`;

        // Button
        const button = document.createElement("button");
        button.className = "bestseller-product-button";
        button.textContent = "View Details";
        button.onclick = () => {
          window.location.href = `view-product.html?productid=${encodeURIComponent(product["product id"])}`;
        };

        // Assemble card
        card.appendChild(imageContainer);
        card.appendChild(name);
        card.appendChild(desc);
        card.appendChild(price);
        card.appendChild(button);

        bestsellerGrid.appendChild(card);
      });
    })
    .catch(error => {
      bestsellerGrid.innerHTML = "<p style='color:#cc5500; font-size:2rem; text-align:center; padding:40px 0;'>Failed to load products.</p>";
      console.error(error);
    });
});

document.addEventListener("DOMContentLoaded", function () {
  const carouselTrack = document.querySelector('.carousel-track');

  // Add loading message
  const loadingMsg = document.createElement("div");
  loadingMsg.textContent = "Loading What's New...";
  loadingMsg.style.color = "#cc5500";
  loadingMsg.style.fontSize = "2rem";
  loadingMsg.style.textAlign = "center";
  loadingMsg.style.padding = "40px 0";
  carouselTrack.appendChild(loadingMsg);

  fetch("https://script.google.com/macros/s/AKfycbyCY8VW0D1A7AFJiU7X6tN5-RTrnYxQIV4QCzmFprxYrCVv2o4uKWnmKfJ6Xh40H4uqXA/exec")
    .then(response => response.json())
    .then(data => {
      // Remove loading message
      carouselTrack.innerHTML = "";

      // Shuffle and pick 6 random products for the carousel
      const shuffled = data.sort(() => 0.5 - Math.random()).slice(0, 6);

      shuffled.forEach(product => {
        const card = document.createElement("div");
        card.className = "whatsnew-product-card";

        // Image
        const imageContainer = document.createElement("div");
        imageContainer.className = "image-container";
        const img = document.createElement("img");
        img.src = product["image url"];
        img.alt = product["product name"] || "Product Image";
        imageContainer.appendChild(img);

        // Name
        const name = document.createElement("h3");
        name.textContent = product["product name"];

        // Description
        const desc = document.createElement("p");
        desc.textContent = product.description;

        // Price
        const price = document.createElement("p");
        price.className = "price";
        price.textContent = `$${product["price per unit"]} per ${product.unit}`;

        // Button
        const button = document.createElement("button");
        button.className = "whatsnew-product-button";
        button.textContent = "View Details";
        button.onclick = () => {
          window.location.href = `view-product.html?productid=${encodeURIComponent(product["product id"])}`;
        };

        // Assemble card
        card.appendChild(imageContainer);
        card.appendChild(name);
        card.appendChild(desc);
        card.appendChild(price);
        card.appendChild(button);

        carouselTrack.appendChild(card);
      });

      // === Carousel logic starts here ===
  const products = carouselTrack.querySelectorAll('.whatsnew-product-card');
  const visibleCount = 3;
  let productIndex = 0;

  // Clone first visibleCount cards and append to the end for seamless looping
  if (products.length > visibleCount) {
    for (let i = 0; i < visibleCount; i++) {
      const clone = products[i].cloneNode(true);
      carouselTrack.appendChild(clone);
    }
  }

  const totalCards = products.length; // Only count real cards

  // Calculate the percentage to move per slide (including gaps)
  const gapPercent = 3; // Must match your CSS gap
  const cardPercent = (100 - (gapPercent * (visibleCount - 1))) / visibleCount;
  const movePercent = cardPercent + gapPercent;

  function moveCarousel() {
    productIndex++;
    carouselTrack.style.transition = 'transform 0.7s cubic-bezier(.77,0,.18,1)';
    carouselTrack.style.transform = `translateX(-${productIndex * movePercent}%)`;

    // When we've shown all original cards, jump instantly to the real first card at the same visual position
    if (productIndex === totalCards) {
      carouselTrack.addEventListener('transitionend', handleReset, { once: true });
    }
  }

  function handleReset() {
    // Instantly jump to the real first card (not to 0, but to the first slide)
    carouselTrack.style.transition = 'none';
    carouselTrack.style.transform = `translateX(0%)`;
    productIndex = 0;
    // Force reflow to apply the transform instantly before re-enabling transition
    void carouselTrack.offsetWidth;
    carouselTrack.style.transition = 'transform 0.7s cubic-bezier(.77,0,.18,1)';
  }

  setInterval(moveCarousel, 7000); // Rotate every 7 seconds
  // === Carousel logic ends here ===
    })
    .catch(error => {
      carouselTrack.innerHTML = "<p style='color:#cc5500; font-size:2rem; text-align:center; padding:40px 0;'>Failed to load products.</p>";
      console.error(error);
    });
});

document.addEventListener("DOMContentLoaded", function () {
  const swiperWrapper = document.querySelector('.whats-new-swiper .swiper-wrapper');

  // Add loading message
  const loadingMsg = document.createElement("div");
  loadingMsg.textContent = "Loading What's New...";
  loadingMsg.style.color = "#cc5500";
  loadingMsg.style.fontSize = "2rem";
  loadingMsg.style.textAlign = "center";
  loadingMsg.style.padding = "40px 0";
  swiperWrapper.appendChild(loadingMsg);

  fetch("https://script.google.com/macros/s/AKfycbyCY8VW0D1A7AFJiU7X6tN5-RTrnYxQIV4QCzmFprxYrCVv2o4uKWnmKfJ6Xh40H4uqXA/exec")
    .then(response => response.json())
    .then(data => {
      swiperWrapper.innerHTML = ""; // Remove loading message

      // Shuffle and pick up to 6 random products for the carousel
      const shuffled = data.sort(() => 0.5 - Math.random()).slice(0, 6);

      shuffled.forEach(product => {
        const slide = document.createElement("div");
        slide.className = "swiper-slide";
        slide.innerHTML = `
          <div class="whatsnew-product-card">
            <div class="image-container">
              <img src="${product["image url"]}" alt="${product["product name"] || "Product Image"}">
            </div>
            <h3>${product["product name"]}</h3>
            <p>${product.description}</p>
            <p class="price">$${product["price per unit"]} per ${product.unit}</p>
            <button class="whatsnew-product-button" onclick="window.location.href='view-product.html?productid=${encodeURIComponent(product["product id"])}'">View Details</button>
          </div>
        `;
        swiperWrapper.appendChild(slide);
      });

      // Initialize Swiper after slides are added
      new Swiper('.whats-new-swiper', {
        slidesPerView: 3,
        spaceBetween: 24,
        loop: true,
        navigation: {
          nextEl: '.swiper-button-next',
          prevEl: '.swiper-button-prev'
        },
        autoplay: {
          delay: 7000,
          disableOnInteraction: false
        },
        pagination: {
          el: '.swiper-pagination',
          clickable: true
        }
      });
    })
    .catch(error => {
      swiperWrapper.innerHTML = "<p style='color:#cc5500; font-size:2rem; text-align:center; padding:40px 0;'>Failed to load products.</p>";
      console.error(error);
    });
});
  </script>

<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
</body>

</html>