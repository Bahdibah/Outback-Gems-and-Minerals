<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Products - Outback Gems</title>
  <link rel="stylesheet" href="natural.css" />
  <link rel="stylesheet" href="navbar.css" />
  <link href="https://fonts.googleapis.com/css2?family=Parisienne&display=swap" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Dancing+Script&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Sacramento&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Allura&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Satisfy&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body>
  <div id="page-wrapper">
    <header id="navbar-container"></header>
    <script src="navbar.js"></script>

    <section id="home">
      <div class="hero-overlay">
        <h2>Natural Products</h2>
        <p>Discover our range of natural mineral and gemstone specimens, each formed by the Earth's own geological processes. 
          From raw crystals to unique matrix pieces, these treasures highlight nature’s artistry. Perfect for collectors</p>
      </div>
    </section>

    <div class="product-header-container">      
      <div class="product-header-title">
        Browse Natural Categories
      </div>
     </div>

     <div class="product-divider"></div>

    <div class="page-layout">

      <div class="product-card-container">
        <div class="product-card" style="background-image: url('images/Natural Sapphire.jpg'); background-size: 100%; background-repeat: no-repeat; background-position: center;">
          <h3>Sapphire</h3>
          <p>Explore the timeless beauty of natural sapphires, prized for their vivid colours and exceptional durability.</p>
          <button class="product-button"><a href="/products.html?category=natural-sapphire" data-category="natural-sapphire">Shop all Sapphires</a></button>
        </div>

        <div class="product-card" style="background-image: url('images/Natural Peridot.jpg'); background-size: 100%; background-repeat: no-repeat; background-position: center;">
          <h3>Peridot</h3>
          <p>Known for its brilliance and fire, natural zircon is a striking gemstone with rich tones and ancient origins.</p>
          <button class="product-button "><a href="/products.html?category=natural-peridot" data-category="natural-peridot">Shop all Peridot</a></button>
        </div>

        <div class="product-card" style="background-image: url('images/Natural Garnet.jpg'); background-size: 100%; background-repeat: no-repeat; background-position: center;">
          <h3>Garnet</h3>
          <p>From deep reds to vibrant greens, natural garnets offer a bold splash of colour in a wide range of varieties.</p>
          <button class="product-button"><a href="/products.html?category=natural-garnet" data-category="natural-garnet">Shop all Garnets</a></button>
        </div>

        <div class="product-card" style="background-image: url('images/Natural Tourmaline.jpg'); background-size: 100%; background-repeat: no-repeat; background-position: center;">
          <h3>Tourmaline</h3>
          <p>Renowned for its wide colour spectrum, tourmaline is a favourite among collectors and gem cutters alike.</p>
          <button class="product-button"><a href="/products.html?category=natural-tourmaline" data-category="natural-tourmaline">Shop all Tourmaline</a></button>
        </div>

        <div class="product-card" style="background-image: url('images/Natural Quartz.jpg'); background-size: 100%; background-repeat: no-repeat; background-position: center;">
          <h3>Quartz</h3>
          <p>A versatile and abundant mineral, quartz appears in countless forms—clear, smoky, amethyst, and more.</p>
          <button class="product-button"><a href="/products.html?category=natural-quartz" data-category="natural-quartz">Shop all Quartz</a></button>
        </div>

        <div class="product-card" style="background-image: url('images/Natural Opal.jpg'); background-size: 100%; background-repeat: no-repeat; background-position: center;">
          <h3>Opal</h3>
          <p>Admired for its dazzling play of colour, natural opal showcases unique patterns and vibrant hues in every stone.</p>
          <button class="product-button"><a href="/products.html?category=natural-opal" data-category="natural-opal">Shop all Opals</a></button>
        </div>

        <div class="product-card" style="background-image: url('images/Natural Spinel.jpg'); background-size: 100%; background-repeat: no-repeat; background-position: center;">
          <h3>Spinel</h3>
          <p>Often mistaken for ruby or sapphire, natural spinel stands out with its excellent clarity and captivating colours.</p>
          <button class="product-button"><a href="/products.html?category=natural-spinel" data-category="natural-spinel">Shop all Spinel</a></button>
        </div>
        
        <div class="product-card" style="background-image: url('images/Natural Zircon.jpg'); background-size: 100%; background-repeat: no-repeat; background-position: center;">
          <h3>Zircon</h3>
          <p>Known for its brilliance and fire, natural zircon is a striking gemstone with rich tones and ancient origins.</p>
          <button class="product-button"><a href="/products.html?category=natural-zircon" data-category="natural-zircon">Shop all Zircons</a></button>
        </div>

      </div>
    </div>
    <button class="view-all-button">View All Natural Prodcuts</button>  
  </div>

    <footer>
      <div class="footer-left">
        <p><a href="Privacy Policy.docx" target="_blank">Privacy Policy</a></p>
        <p><a href="Terms of Use.docx" target="_blank">Terms Of Use</a></p>
      </div>
      <div class="footer-middle">
        <p>&copy; 2025 Outback Gems &amp; Minerals. All rights reserved.</p>
        <p>ABN: 0123456789</p>
      </div>
      <div class="footer-right">
        <p><a href="outbackgems@outlook.com"><i class="fa fa-envelope" aria-hidden="true" style="color:white"></i></a></p>
        <p><a href="https://www.facebook.com/"><i class="fa fa-facebook-square" aria-hidden="true" style="color:white"></i></a></p>
      </div>
    </footer>

    <script src="navbar.js"></script>
    
  <script>
    // Background image rotation
    const images = ["images/Natural Banner 1.jpg", "images/Natural Banner 2.jpg", "images/Natural Banner 3.jpg", "images/Natural Banner 4.jpg"];
      let current = 0;
  
      setInterval(() => {
        current = (current + 1) % images.length;
        document.getElementById("home").style.backgroundImage = `url('${images[current]}')`;
      }, 15000); // Change image every 15 seconds
  </script>    
  

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const productContainer = document.getElementById("product-container");
      const productHeader = document.querySelector(".product-header-title");

      // Function to get the query parameter value
      function getQueryParam(param) {
        const urlParams = new URLSearchParams(window.location.search);
        return urlParams.get(param);
      }

      // Get the category from the query parameter
      const categoryKeyword = getQueryParam("category");

      // Simulate a click on the corresponding side menu item if a category is provided
      if (categoryKeyword) {
        const sideMenuItem = document.querySelector(`.side-menu-toggle[data-category="${categoryKeyword}"]`);
        if (sideMenuItem) {
          // Trigger the click functionality
          loadProductsByCategory(categoryKeyword);
        } else {
          console.warn(`No side menu item found for category: ${categoryKeyword}`);
          loadProductsByCategory(); // Fallback to load all products
        }
      } else {
        loadProductsByCategory(); // Load all products if no category is specified
      }

      // Add event listeners to side menu toggles
      const sideMenuToggles = document.querySelectorAll(".side-menu-toggle");
      sideMenuToggles.forEach(toggle => {
        toggle.addEventListener("click", function () {
          const categoryKeyword = this.getAttribute("data-category"); // Get the keyword from the toggle

          // Update the URL dynamically without reloading the page
          const newUrl = `${window.location.pathname}?category=${encodeURIComponent(categoryKeyword)}`;
          history.pushState({ category: categoryKeyword }, "", newUrl);

          // Load products for the selected keyword
          loadProductsByCategory(categoryKeyword);
        });
      });

      // Function to load products by category keyword
      function loadProductsByCategory(keyword = null) {
        // Show loading indicator
        productContainer.innerHTML = "<p>Loading products...</p>";

        fetch("https://script.google.com/macros/s/AKfycbyCY8VW0D1A7AFJiU7X6tN5-RTrnYxQIV4QCzmFprxYrCVv2o4uKWnmKfJ6Xh40H4uqXA/exec")
          .then(response => response.json())
          .then(data => {
            if (data && data.length > 0) {
              let filteredProducts;

              // Filter products by keyword if a keyword is provided
              if (keyword) {
                filteredProducts = data.filter(product => product.category.includes(keyword));
              } else {
                // If no keyword is provided, display all products
                filteredProducts = data;
              }

              // Display filtered products
              displayProducts(filteredProducts, keyword ? `Products in ${keyword}` : "All Products", keyword, data);
            } else {
              productContainer.innerHTML = "<p>No products found.</p>";
            }
          })
          .catch(error => {
            console.error("Error fetching product data:", error);
            productContainer.innerHTML = "<p style='color: red;'>Failed to load products. Please try again later.</p>";
          });
      }

      // Function to display products
      function displayProducts(products, headerTitle, keyword, data) {
        // Clear the product container and reattach the product header
        productContainer.innerHTML = "";
        productContainer.appendChild(productHeader);
      
        // Update the product header title
        const productHeaderTitle = document.querySelector(".product-header-title");
        productHeaderTitle.textContent = headerTitle;
      
        // Display products
        if (products.length > 0) {
          const displayedProducts = []; // Track displayed products
      
          products.forEach(product => {
            const productCard = document.createElement("div");
            productCard.classList.add("product-card");
      
            // Image
            const imageContainer = document.createElement("div");
            imageContainer.classList.add("image-container");
            const img = document.createElement("img");
            img.src = product["image url"];
            img.alt = product["product name"] || "Product Image";
            imageContainer.appendChild(img);
      
            // Product name
            const productName = document.createElement("h3");
            productName.textContent = product["product name"];
      
            // Description
            const productDescription = document.createElement("p");
            productDescription.textContent = product.description;
      
            // Price per unit and unit (same line)
            const priceLine = document.createElement("p");
            priceLine.textContent = `$${product["price per unit"]} per ${product.unit}`;
      
            // Button with link to view-product.html?productname=XYZ
            const productButton = document.createElement("button");
            productButton.classList.add("product-button");
            productButton.textContent = "View Details";
            productButton.onclick = () => {
              window.location.href = `view-product.html?productid=${encodeURIComponent(product["product id"])}`;
            };
      
            // Assemble card
            productCard.appendChild(imageContainer);
            productCard.appendChild(productName);
            productCard.appendChild(productDescription);
            productCard.appendChild(priceLine);
            productCard.appendChild(productButton);
      
            productContainer.appendChild(productCard);
      
            // Add the product to the displayedProducts array
            displayedProducts.push(product);
          });
      
          // If fewer than 4 products are displayed, suggest additional products
          if (products.length < 4) {
            suggestAdditionalProducts(keyword, displayedProducts, data);
          }
        } else {
          // No products found
          productContainer.innerHTML = "<p>No products found in this category. How about checking out these popular items?</p>";
          suggestAdditionalProducts(keyword, [], data);
        }
      }
      
      // Function to suggest additional products
      function suggestAdditionalProducts(currentCategory, displayedProducts, data) {
        // Ensure displayedProducts is an array
        displayedProducts = displayedProducts || [];

        // Get the names of already displayed products
        const displayedProductNames = new Set(displayedProducts.map(product => product["product name"]));

        // Determine the broader category (e.g., "natural" or "synthetic")
        const broaderCategory = currentCategory.split("-")[0]; // Extract the first part of the category

        // Filter products from the broader category and exclude already displayed products
        const filteredSuggestions = data.filter(product => 
          product.category.includes(broaderCategory) && !displayedProductNames.has(product["product name"])
        );

        // Shuffle the suggestions and pick the first 3
        const shuffledSuggestions = filteredSuggestions.sort(() => 0.5 - Math.random()).slice(0, 3);

        // Create a container for suggested products
        const suggestionContainer = document.createElement("div");
        suggestionContainer.classList.add("suggestion-container");

        // Add suggestion header
        const suggestionHeader = document.createElement("div");
        suggestionHeader.classList.add("product-header-title");
        suggestionHeader.textContent = "You May Also Like";
        suggestionContainer.appendChild(suggestionHeader);

        // Check if there are suggestions
        if (shuffledSuggestions.length > 0) {
          // Display the suggestions
          shuffledSuggestions.forEach(product => {
            const productCard = document.createElement("div");
            productCard.classList.add("product-card");

            // Image
            const imageContainer = document.createElement("div");
            imageContainer.classList.add("image-container");
            const img = document.createElement("img");
            img.src = product["image url"];
            img.alt = product["product name"] || "Product Image";
            imageContainer.appendChild(img);

            // Product name
            const productName = document.createElement("h3");
            productName.textContent = product["product name"];

            // Description
            const productDescription = document.createElement("p");
            productDescription.textContent = product.description;

            // Price per unit and unit (same line)
            const priceLine = document.createElement("p");
            priceLine.textContent = `$${product["price per unit"]} per ${product.unit}`;

            // Button with link to view-product.html?productname=XYZ
            const productButton = document.createElement("button");
            productButton.classList.add("product-button");
            productButton.textContent = "View Details";
            productButton.onclick = () => {
              window.location.href = `view-product.html?productid=${encodeURIComponent(product["product id"])}`;
            };

            // Assemble card
            productCard.appendChild(imageContainer);
            productCard.appendChild(productName);
            productCard.appendChild(productDescription);
            productCard.appendChild(priceLine);
            productCard.appendChild(productButton);

            suggestionContainer.appendChild(productCard);
          });
        } else {
          // Add a fallback message if no suggestions are found
          const noSuggestionsMessage = document.createElement("p");
          noSuggestionsMessage.textContent = "No additional suggestions available.";
          suggestionContainer.appendChild(noSuggestionsMessage);
        }

        // Append the suggestion container to the product container
        productContainer.appendChild(suggestionContainer);
      }
    });
  </script>
</body>
</html>